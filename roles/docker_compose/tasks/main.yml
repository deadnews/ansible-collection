---
# Deploy Docker Compose projects

- name: Check docker_compose_files is a non-empty list when docker_compose_state is present
  ansible.builtin.fail:
    msg: The parameter 'docker_compose_files' is required when 'docker_compose_state' is 'present'
  when:
    - docker_compose_state == 'present'
    - docker_compose_files | default([]) | length > 0

- name: Deploy Docker Compose project
  when: docker_compose_state == 'present'
  ansible.builtin.include_role:
    name: deadnews.util.docker_compose
    tasks_from: deploy

- name: Remove Docker Compose project
  when: docker_compose_state == 'absent'
  ansible.builtin.include_role:
    name: deadnews.util.docker_compose
    tasks_from: remove
